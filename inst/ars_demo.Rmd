---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(HTLR)
set.seed(1234)
## a direct rejection sampling for truncated normal
sample_tnorm_drs <- function (n, lb = -Inf, ub = Inf)
{
  x <- rep (0, n)
  for (i in 1:n)
  {
    rej <- TRUE
    while (rej)
    {
      x[i] <- rnorm (1)
      if (x[i] >= lb & x[i] <= ub)
        rej <- FALSE
    }
  }
  return(x)
}

system.time(x1 <- sample_trunc_norm(n = 50000, lb = -1, ub = Inf))
system.time(x2 <- sample_tnorm_drs(n = 50000, lb = -1, ub = Inf))
hist (x1, main = "ARS Samples of N(0,1)I(x>-1)")
qqplot (x1, x2,
        xlab = "Quantiles of ARS Samples",
        ylab = "Quantiles of DRS Samples",
        main = "QQ-plot of Samples of N(0,1)I(x>-1)")
```

```{r}
## sample from the tail of normal
system.time(x1 <- sample_trunc_norm(n = 5000, lb = 3, ub = Inf))
system.time(x2 <- sample_tnorm_drs(n = 5000, lb = 3, ub = Inf))
hist(x1, main = "Histogram of ARS Samples of N(0,1)I(x>3)")
qqplot (x1, x2,
        xlab = "Quantiles of ARS Samples",
        ylab = "Quantiles of DRS Samples",
        main = "QQ-plot of Samples of N(0,1)I(x>3)")
```

```{r}
## sample from normal constraint in a very small interval
system.time(x1 <- sample_trunc_norm(n = 5000, lb = 3, ub = 4))
system.time(x2 <- sample_tnorm_drs(n = 5000, lb = 3, ub = 4))
hist (x1, main = "Histogram of ARS Samples of N(0,1)I(3<x4)")
qqplot (x1, x2,
        xlab = "Quantiles of ARS Samples",
        ylab = "Quantiles of DRS Samples",
        main = "QQ-plot of Samples of N(0,1)I(3<x<4)")
```

```{r}
## generate Inverse-Chisq samples
p <- 100
alpha1 <- 0.5
w <- exp (-10)
sigmasq <- 1 / rgamma (p, alpha1/2, alpha1*w/2)

## sample from the posterior of w with ARS
rn_s <- sample_post_ichi(n = 10000, sigmasq = sigmasq, alpha1 = alpha1)

## plot the samples
plot(rn_s, main = bquote(paste("ARS Samples of Posterior of Inv-", chi^2)),
      ylab = "log (w)")
abline(h = log(w), col = "red", lwd = 2)
hist(rn_s, main = "Histogram", xlab = "log(w)")
abline(v = log(w), col = "red", lwd = 2)
```

```{r}
## test with standard method
system.time(arsrnbeta <- sample_trunc_beta(n = 50000, alpha = 0.1, beta = 0.1))
system.time(drnbeta <- rbeta(n = 50000, shape1 = 0.1, shape2 = 0.1))
qqplot(arsrnbeta, drnbeta,
       main = "QQ-plot of Beta Samples",
       xlab = "Quantiles of ARS Samples",
       ylab = "Quantiles of Standard Samples")

## truncated beta
arsrnbeta <- HTLR::sample_trunc_beta(n = 50000, alpha = 0.1, beta = 5, lb = 0.1, ub = 0.5)
hist(arsrnbeta,
     main = "Histogram of Truncated Beta Samples",
     xlab = "b")
```

